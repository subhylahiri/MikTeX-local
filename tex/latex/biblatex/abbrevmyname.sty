%%  Abbreviate a specific name in citations.
%%  Useful for slides etc.
%%
%%  Put \myname{Smith} in your preamble.
%%
%% Requires packages: biblatex, xstring
%%
%%
%% See https://tex.stackexchange.com/a/73246/147422
%================================================================================
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{abbrevmyname}[2018/5/13 abbreviate a specific name (SL)]
%--------------------------------------------------------------------------------
\@ifpackageloaded{biblatex}{}{\PackageWarning{abbrevmyname}{This package requires biblatex}}
%================================================================================
\RequirePackage{xstring}
\makeatletter
%--------------------------------------------------------------------------------
\providecommand{\highlightname}{}
\providecommand{\myname}[1]{\renewcommand{\highlightname}{#1}}
\providebibmacro{ifhighlightname}[3]{\IfSubStr{#1}{\highlightname}{#2}{#3}}%
%--------------------------------------------------------------------------------
\letcs{\old@abx@labelname}{abx@nfd@*@labelname}
\DeclareNameFormat{labelname}{%
  \usebibmacro{ifhighlightname}{\namepartgiven\namepartprefix\namepartfamily\namepartsuffix}%
    {\usebibmacro{name:family}%
        {\namepartgiveni\namepartprefixi\namepartfamilyi\namepartsuffixi}%
        {\namepartgiveni}%
        {\relax}%
        {\namepartsuffixi}
     \usebibmacro{name:andothers}}%
    {\old@abx@labelname}
}%
%--------------------------------------------------------------------------------
%\DeclareNameFormat{labelname}{%
%  \ifcase\value{uniquename}%
%    \usebibmacro{name:family}
%      {\namepartfamily}
%      {\namepartgiven}
%      {\namepartprefix}
%      {\namepartsuffix}%
%  \or
%    \ifuseprefix
%      {\usebibmacro{name:given-family}
%        {\namepartfamily}
%        {\namepartgiveni}
%        {\namepartprefix}
%        {\namepartsuffixi}}
%      {\usebibmacro{name:given-family}
%        {\namepartfamily}
%        {\namepartgiveni}
%        {\namepartprefixi}
%        {\namepartsuffixi}}%
%  \or
%    \usebibmacro{name:given-family}
%      {\namepartfamily}
%      {\namepartgiven}
%      {\namepartprefix}
%      {\namepartsuffix}%
%  \fi
%  \usebibmacro{name:andothers}
%}%
%================================================================================
\makeatother
%================================================================================
\endinput
